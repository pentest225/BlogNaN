<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Gentelella Alela! |</title>

    <!-- Bootstrap -->
    <link
      href="/static/admin/vendors/bootstrap/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      href="/static/admin/vendors/font-awesome/css/font-awesome.min.css"
      rel="stylesheet"
    />
    <!-- NProgress -->
    <link
      href="/static/admin/vendors/nprogress/nprogress.css"
      rel="stylesheet"
    />
    <!-- iCheck -->
    <link
      href="/static/admin/vendors/iCheck/skins/flat/green.css"
      rel="stylesheet"
    />

    <!-- Custom Theme Style -->
    <link href="/static/admin/build/css/custom.min.css" rel="stylesheet" />
  </head>

  <body class="nav-md">
    <div id="app">
    <div class="container body">
      <div class="main_container">
        <div class="col-md-3 left_col">
            <div class="left_col scroll-view">
                <div class="navbar nav_title" style="border: 0;">
                    <a href="{% url 'admin_visiteur_dash' %}" class="site_title"><i class="fa fa-paw"></i> <span>Admin
                            Visiteur</span></a>
                </div>
        
                <div class="clearfix"></div>
        
                <!-- menu profile quick info -->
                <div class="profile clearfix">
                    <div class="profile_pic">
                        <img src="{{user.image.url}}" alt="..." class="img-circle profile_img">
                    </div>
                    <div class="profile_info">
                        <span>Welcome,</span>
                        <h2>{{user.username}}</h2>
                    </div>
                </div>
                <!-- /menu profile quick info -->
        
                <br />
        
                <!-- sidebar menu -->
                <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
                    <div class="menu_section">
                        <h3>General</h3>
                        <ul class="nav side-menu">
                            <li><a><i class="fa fa-home"></i> Home <span class="fa fa-chevron-down"></span></a>
                                <ul class="nav child_menu">
                                    <li><a href="{% url 'admin_visiteur_dash' %}">Dashboard</a></li>
                                    <li><a href="{% url 'admin_visiteur_dash' %}">Devenir Membre</a></li>
                                </ul>
                            </li>
                            <li><a><i class="fa fa-edit"></i> Forms <span class="fa fa-chevron-down"></span></a>
                                <ul class="nav child_menu">
                                    <li><a href="{% url 'tables_visiteur_dash' %}">Mes Commentaires</a></li>
                                    <li><a href="{% url 'profil_visiteur_dash' %}">Profile</a></li>
                                </ul>
                            </li>
                            <li><a><i class="fa fa-edit"></i> Catégorie <span class="fa fa-chevron-down"></span></a>
                                <ul class="nav child_menu">
                                    <li v-for="item in dataAllCategory"><a :href=`${base_url}/`+`category/`+`${item.node.id}`>${ item.node.nom }</a> </li>
                                </ul>
                            </li>
        
                        </ul>
                    </div>
        
        
                </div>
                <!-- /sidebar menu -->
        
                <!-- /menu footer buttons -->
                <div class="sidebar-footer hidden-small">
                    <a data-toggle="tooltip" data-placement="top" title="Settings">
                        <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
                    </a>
                    <a data-toggle="tooltip" data-placement="top" title="FullScreen">
                        <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
                    </a>
                    <a data-toggle="tooltip" data-placement="top" title="Lock">
                        <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
                    </a>
                    <a data-toggle="tooltip" data-placement="top" title="Logout" href="{% url 'account_logout' %}">
                        <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
                    </a>
                </div>
                <!-- /menu footer buttons -->
            </div>
        </div>
        
        <!-- top navigation -->
        <div class="top_nav">
            <div class="nav_menu">
                <div class="nav toggle">
                    <a id="menu_toggle"><i class="fa fa-bars"></i></a>
                </div>
                <nav class="nav navbar-nav">
                    <ul class=" navbar-right">
                        <li class="nav-item dropdown open" style="padding-left: 15px;">
                            <a href="javascript:;" class="user-profile dropdown-toggle" aria-haspopup="true" id="navbarDropdown"
                                data-toggle="dropdown" aria-expanded="false">
                                <img src="{{user.image.url}}" alt="">{{ user.last_name }} {{ user.first_name }}
                            </a>
                            <div class="dropdown-menu dropdown-usermenu pull-right" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="{% url 'profil_visiteur_dash' %}"> Profile</a>
                                <a class="dropdown-item" href="{% url 'account_change_password' %}"> Changer votre mot de passe</a>
                                <a class="dropdown-item" href="javascript:;">Help</a>
                                <a class="dropdown-item"  href="{% url 'account_logout' %}"><i class="fa fa-sign-out pull-right"></i> Log Out</a>
                            </div>
                        </li>
        
                        <li role="presentation" class="nav-item dropdown open">
                            <a href="javascript:;" class="dropdown-toggle info-number" id="navbarDropdown1"
                                data-toggle="dropdown" aria-expanded="false">
                                <i class="fa fa-envelope-o"></i>
                                <span class="badge bg-green">1</span>
                            </a>
                            <ul class="dropdown-menu list-unstyled msg_list" role="menu" aria-labelledby="navbarDropdown1">
                                <li class="nav-item">
                                    <a class="dropdown-item">
                                        <span class="image"><img src="/static/admin/images/img.jpg"
                                                alt="Profile Image" /></span>
                                        <span>
                                            <span>John Smith</span>
                                            <span class="time">3 mins ago</span>
                                        </span>
                                        <span class="message">
                                            Film festivals used to be do-or-die moments for movie makers. They were where...
                                        </span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
        <!-- /top navigation -->
        {% block content %} 
        
        {% endblock content %}

        <!-- footer content -->
        <footer>
          <div class="pull-right">
            Gentelella - Bootstrap Admin Template by
            <a href="https://colorlib.com">Colorlib</a>
          </div>
          <div class="clearfix"></div>
        </footer>
        <!-- /footer content -->
      </div>
    </div>
    </div>
   
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
    var app = new Vue({
            el: '#app',
            data: {
                base_url: '',
                dataAllCategory: [],
                userinfos: [],
                dataAllarticle: [],
                datSingleCategory: [],
                singleAtircle: [],
                categoryId: '',
                // CarouselAll: [],
                // Popular: [],
                idcat: '',
                idart: '',
                utilisateur: '',
                nom: '',
                sujet: '',
                email: '',
                message: '',
                suscribe: '',
                search: '',
                base_url: '',
                reponse: '',
                commentform: true,
                reponseform: false,
                searchdiv: false,
                searchmessage: '',
                trouver: '',
            },
            delimiters: ["${", "}"],
            mounted() {
                this.utilisateur = "{{user.username}}";
                this.idart = "{{idart}}";
                this.getdata()
                //this.reponsebutton()
            },
            methods: {
                getdata: function () {
                    this.base_url = 'https://127.0.0.1:8000'
                    console.log('data getting')
                    axios.defaults.xsrfCookieName = 'csrftoken'
                    axios.defaults.xsrfHeaderName = 'X-CSRFToken'
                    axios({
                        url: this.base_url + '/graphql',
                        method: 'post',
                        data: {
                            query: `
                               query{
                                    allUser(username:"${ this.utilisateur }"){
                                        edges{
                                        node{
                                            firstName,
                                            lastName,
                                            username,
                                            email,
                                            userLike{
                                            edges{
                                                node{
                                                article{
                                                    titre,
                                                    vue,
                                                    categorie{
                                                    nom,
                                                    }
                                                    contenu,
                                                    image,
                                                    description,
                                                    imageSingle,
                                                    articleCommentaire {
                                                    edges {
                                                        node {
                                                        user{
                                                            username,
                                                            firstName,
                                                            lastName,
                                                        }
                                                                        message
                                                        dateUpd
                                                        dateAdd
                                                        }
                                                    }
                                                    }
                                                }
                                                
                                                }
                                            }
                                            }
                                        }
                                        }
                                    }
                                    allCategories{
                                        edges{
                                            node{
                                                nom,
                                                id,
                                                articleCategorie{
                                                totalCount,
                                                edges{
                                                    node{
                                                    id,
                                                    titre,
                                                    vue,
                                                    contenu,
                                                    image,
                                                    description,
                                                    imageSingle,
                                                    dateAdd
                                                    Dislike{
                                                        edgeCount,
                                                        edges{
                                                        node{
                                                            user{
                                                            username,
                                                            lastName,
                                                            firstName,
                                                            }
                                                        }
                                                        }
                                                    }
                                                    articleLike{
                                                        edgeCount,
                                                        edges{
                                                        node{
                                                            user{
                                                            username, 
                                                            lastName,
                                                            firstName,
                                                            }
                                                        }
                                                        }
                                                    }
                                                    }
                                                }
                                                }
                                            }
                                        }
                                    }
                                    }
                                    
                                `
                        }
                    })
                        .then(response => {
                            result = response.data.data
                            console.log('sddsf')
                            console.log(result)
                            this.dataAllCategory = result.allCategories.edges
                            this.userinfos = result.allUser.edges
                            console.log(this.dataAllCategory)
                            console.log(this.userinfos)
                            this.categoryId = result.category
                            // this.dataAllarticle = result.allArticles.edges
                            // this.categoryId = result.category
                            // this.singleAtircle = result.article
                            // this.CarouselAll = this.dataAllarticle.slice(1, 4)
                            //this.Popular = result.allArticles.edges.node
                            //console.log(this.idcat)
                            //console.log(this.idart)
                            // console.log(this.categoryId)

                        })
                        .catch((err) => {
                            console.log(err);
                        })
                },
                // sendmessage: function () {
                //     axios.defaults.xsrfCookieName = 'csrftoken'
                //     axios.defaults.xsrfHeaderName = 'X-CSRFToken'
                //     let formData = new FormData();
                //     formData.append('nom', '' + this.nom);
                //     formData.append('sujet', '' + this.sujet);
                //     formData.append('email', '' + this.email);
                //     formData.append('message', '' + this.message);
                //     axios.post('https://127.0.0.1:8000/contacts/message', formData,
                //         {
                //         }).then(response => {
                //             console.log(response)
                //             if (response.data.succes == true) {
                //                 new Toast({
                //                     message: 'Votre Message a été envoyé avec Success',
                //                     type: 'success'
                //                 });
                //                 this.nom = ''
                //                 this.message = ''
                //                 this.email = ''
                //                 this.sujet = ''
                //             } else {
                //                 swal("Tous les champs Sont requis", "", "error");
                //             }

                //         })
                //         .catch((err) => {
                //             console.log(err);
                //         })
                // },
                // suscription: function () {
                //     axios.defaults.xsrfCookieName = 'csrftoken'
                //     axios.defaults.xsrfHeaderName = 'X-CSRFToken'
                //     let formData = new FormData();
                //     formData.append('suscribe', '' + this.suscribe);
                //     axios.post('https://127.0.0.1:8000/contacts/souscription', formData,
                //         {
                //         }).then(response => {

                //             console.log(response)
                //             if (response.data.succes == true) {
                //                 swal("Merci d'avoir Souscrire au Service Newlestter", "", "success");
                //                 this.email = ''

                //             } else {
                //                 swal("Entrer Votre adresse Mail pour Souscrire Au service Newlestter de nan blog", "", "error");
                //             }

                //         })
                //         .catch((err) => {
                //             console.log(err);
                //         })
                // },
                // postcomment: function () {
                //     this.base_url = 'https://127.0.0.1:8000'
                //     let formData = new FormData();
                //     axios.defaults.xsrfCookieName = 'csrftoken'
                //     axios.defaults.xsrfHeaderName = 'X-CSRFToken'
                //     formData.append('commentaire', '' + this.commentaire);
                //     // console.log(this.commentaire);
                //     // console.log (this.idart);
                //     axios({
                //         url: this.base_url + '/graphql',
                //         method: 'post',
                //         data: {
                //             query: `
                //                 mutation{
                //                     relayCreateComment(input:{sujet:"testgraph",message:"${ this.commentaire}",article:"${this.idart}",status:true}){
                //                       comment{
                //                         message
                //                       }
                //                     }
                //                   }
                //             `
                //         }
                //     })
                //         .then(response => {
                //             console.log(response)
                //             if (response.data.data.relayCreateComment != null) {
                //                 new Toast({
                //                     message: 'Commentaire envoyer avec success',
                //                     type: 'success'
                //                 });
                //             } else {
                //                 swal("Entrer Votre Commentaire ");
                //             }
                //         })
                //         .catch((err) => {
                //             console.log(err);
                //         })
                // },
                // searchpost: function () {
                //     this.base_url = 'https://127.0.0.1:8000'
                //     console.log('data getting')
                //     let formData = new FormData();
                //     axios.defaults.xsrfCookieName = 'csrftoken'
                //     axios.defaults.xsrfHeaderName = 'X-CSRFToken'
                //     formData.append('search', '' + this.search);
                //     axios({
                //         url: this.base_url + '/graphql',
                //         method: 'post',
                //         data: {
                //             query: `
                //                 query{
                //                     allArticles(status:true,titre_Icontains:"${ this.search}"){
                //                                                           edges{
                //                                                               node{
                //                                                                   id,titre,image,imageSingle,description,dateAdd,dateUpd,isArchive
                //                                                                   tag{
                //                                                                   edges{
                //                                                                       node{
                //                                                                       id,nom
                //                                                                       }
                //                                                                   }
                //                                                                               },
                //                                                                   categorie{
                //                                                                   nom
                //                                                                   },
                //                                                                   articleCommentaire{
                //                                                                   edges{
                //                                                                       node{
                //                                                                       user{
                //                                                                           id,username,image,lastName,firstName
                //                                                                       },
                //                                                                         response{
                //                                                                           edges{
                //                                                                             node{
                //                                                                               user{
                //                                                                                 id,firstName,lastName,image
                //                                                                               }
                //                                                                             }
                //                                                                           }
                //                                                                         },
                //                                                                       ,message,sujet,dateAdd,dateUpd
                //                                                                       }
                //                                                                   }
                //                                                       },
                //                                                                   auteur{
                //                                                                   username,firstName,email,isStaff,isActive,image,description,lastName
                //                                                                   social{
                //                                                                       edges{
                //                                                                       node{
                //                                                                           id,name,lien
                //                                                                       }
                //                                                                       }
                //                                                                   },
                //                                                                   specialite{
                //                                                                       edges{
                //                                                                       node{
                //                                                                           id,specialiste
                //                                                                       }
                //                                                                       }
                //                                                                   }
                //                                                       },
                //                                                                     articleLike{
                //                                                                       edgeCount
                //                                                                     edges{
                //                                                                       node{
                //                                                                         user{
                //                                                                           id,lastName,firstName,image
                //                                                                         }
                //                                                                       }
                //                                                                     }
                //                                                                   },
                //                                                                 contenu,isArchive
                //                                                               }   
                //                                                               }
                //                                                       }
                //                   }
                //             `

                //         }
                //     })
                //         .then(response => {
                //             result = response.data.data
                //             this.dataAllarticle = result.allArticles.edges
                //             this.trouver = this.dataAllarticle.length
                //             this.searchmessage = (this.trouver + ' Resultat Trouver Pour la Recherche ' + this.search)
                //             this.searchdiv = true
                //         })
                //         .catch((err) => {
                //             console.log(err);
                //         })
                // },
                // postDislike: function () {
                //     this.base_url = 'https://127.0.0.1:8000'
                //     console.log('data getting')
                //     axios.defaults.xsrfCookieName = 'csrftoken'
                //     axios.defaults.xsrfHeaderName = 'X-CSRFToken'
                //     axios({
                //         url: this.base_url + '/graphql',
                //         method: 'post',
                //         data: {
                //             query: `
                //                     mutation{
                //                         relayCreateDislike(input:{article:"${ this.idart}",status:true}){
                //                             disLike {
                //                             status
                //                         }
                //                     }
                //                 }
                //                 `
                //         }
                //     })
                //         .then(response => {
                //             if (response.data.data.relayCreateComment != null) {
                //                 new Toast({
                //                     message: 'Article Dislike',
                //                     type: 'success'
                //                 });
                //             } else {
                //                 new Toast({
                //                     message: 'Article Dislike',
                //                     type: 'success'
                //                 });
                //             }
                //         })
                //         .catch((err) => {
                //             console.log(err);
                //         })
                // },
                // postreponse: function () {
                //     this.base_url = 'https://127.0.0.1:8000'
                //     console.log('data getting')
                //     axios.defaults.xsrfCookieName = 'csrftoken'
                //     axios.defaults.xsrfHeaderName = 'X-CSRFToken'
                //     formData.append('reponse', '' + this.reponse);
                //     axios({
                //         url: this.base_url + '/graphql',
                //         method: 'post',
                //         data: {
                //             query: `
                //                     mutation{
                //               relayCreateResponseComment(input:{commentaire:"",message:"${ this.idart}",status:true}){
                //                 response{
                //                   message
                //                     }
                //                   }
                //                 }
                //                 `
                //         }
                //     })
                //         .then(response => {
                //             console.log(response)
                //             if (response.data.data.relayCreateComment != null) {
                //                 new Toast({
                //                     message: 'Commentaire envoyer avec success',
                //                     type: 'success'
                //                 });
                //             } else {
                //                 swal("Entrer Votre Commentaire ");
                //             }
                //         })
                //         .catch((err) => {
                //             console.log(err);
                //         })
                // },
                // reponsebutton: function () {
                //     this.commentform = false;
                //     this.reponseform = true;
                // },
                // postlike: function () {
                //     this.base_url = 'https://127.0.0.1:8000'
                //     console.log('data getting')
                //     axios.defaults.xsrfCookieName = 'csrftoken'
                //     axios.defaults.xsrfHeaderName = 'X-CSRFToken'
                //     axios({
                //         url: this.base_url + '/graphql',
                //         method: 'post',
                //         data: {
                //             query: `
                //                     mutation{
                //                     relayCreatLike(input:{article:"${ this.idart}",status:true}){
                //                             like {
                //                             status
                //                         }
                //                     }
                //                 }
                //                 `
                //         }
                //     })
                //         .then(response => {
                //             if (response.data.data.relayCreateComment != null) {
                //                 new Toast({
                //                     message: 'Article like',
                //                     type: 'success'
                //                 });
                //             } else {
                //                 new Toast({
                //                     message: 'Article like',
                //                     type: 'success'
                //                 });
                //             }
                //         })
                //         .catch((err) => {
                //             console.log(err);
                //         })
                // },



            },




        })
    
    </script>
    <!-- Custom Theme Scripts -->
    <script src="/static/admin/build/js/custom.min.js"></script>
    <!-- jQuery -->
    <script src="/static/admin/vendors/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="/static/admin/vendors/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <!-- FastClick -->
    <script src="/static/admin/vendors/fastclick/lib/fastclick.js"></script>
    <!-- NProgress -->
    <script src="/static/admin/vendors/nprogress/nprogress.js"></script>
    <!-- Chart.js -->
    <script src="/static/admin/vendors/Chart.js/dist/Chart.min.js"></script>
    <!-- gauge.js -->
    <script src="/static/admin/vendors/gauge.js/dist/gauge.min.js"></script>
    <!-- bootstrap-progressbar -->
    <script src="/static/admin/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
    <!-- iCheck -->
    <script src="/static/admin/vendors/iCheck/icheck.min.js"></script>
    <!-- Skycons -->
    <script src="/static/admin/vendors/skycons/skycons.js"></script>
    <!-- Flot -->
    <script src="/static/admin/vendors/Flot/jquery.flot.js"></script>
    <script src="/static/admin/vendors/Flot/jquery.flot.pie.js"></script>
    <script src="/static/admin/vendors/Flot/jquery.flot.time.js"></script>
    <script src="/static/admin/vendors/Flot/jquery.flot.stack.js"></script>
    <script src="/static/admin/vendors/Flot/jquery.flot.resize.js"></script>
    <!-- Flot plugins -->
    <script src="/static/admin/vendors/flot.orderbars/js/jquery.flot.orderBars.js"></script>
    <script src="/static/admin/vendors/flot-spline/js/jquery.flot.spline.min.js"></script>
    <script src="/static/admin/vendors/flot.curvedlines/curvedLines.js"></script>
    <!-- DateJS -->
    <script src="/static/admin/vendors/DateJS/build/date.js"></script>
    <!-- JQVMap -->
    <script src="/static/admin/vendors/jqvmap/dist/jquery.vmap.js"></script>
    <script src="/static/admin/vendors/jqvmap/dist/maps/jquery.vmap.world.js"></script>
    <script src="/static/admin/vendors/jqvmap/examples/js/jquery.vmap.sampledata.js"></script>
    <!-- bootstrap-daterangepicker -->
    <script src="/static/admin/vendors/moment/min/moment.min.js"></script>
    <script src="/static/admin/vendors/bootstrap-daterangepicker/daterangepicker.js"></script>
    
    <!-- Custom Theme Scripts -->
    <script src="/static/admin/build/js/custom.min.js"></script>
  </body>
</html>
